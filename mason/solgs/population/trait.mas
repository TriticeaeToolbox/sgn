<%args>

$pop_id
$show_data => 1;
$accuracy_report
$model_parameters
$top_blups
$blups_download_url
$marker_effects_download_url
$top_marker_effects
$validation_download_url
$trait_abbr
$trait_name
$project_name
$project_desc
$stocks_no
$markers_no
$traits_no
$trait_id
$descriptive_stat
$selection_prediction_download =>''
$prediction_pop_id => ''
$list_of_prediction_pops=> ''
$prediction_pop_name => ''
$analyzed_traits => ''
$owner=>''
$protocol_url => ''
$combo_pops_id => ''
$genotyping_protocol_id => ''
</%args>

<%perl>

my $pop_link = qq | <a href="/solgs/population/$pop_id/gp/$genotyping_protocol_id">$project_name</a> |;

</%perl>



    <& /util/import_javascript.mas, classes => ["d3.d3Min", "solGS.histogram", "solGS.phenotypeDataFlot", 
                                              "flot.flot", "flot.categories", 
                                              "flot.tooltip", "flot.selection", "flot.navigate", 
                                              "flot.axisLabels", "statistics/simple_statistics"] 
    &>


<& /util/import_css.mas, paths => ['/static/css/solgs/solgs.css'] &>

<& /page/page_title.mas, 
   title => "Genomic selection model for $trait_name ($trait_abbr) in $project_name"
&>

<&| /page/info_section.mas, 
  collapsible => 1, 
  collapsed   => 0, 
  title       => "Training population summary",
  &>

 <& summary.mas,
    project_id   => $pop_id,
    pop_link     => $pop_link,
    project_name => $project_name,
    project_desc => $project_desc,
    stocks_no    => $stocks_no,
    markers_no   => $markers_no,
    traits_no    => $traits_no,
    owner        => $owner,
    protocol_url => $protocol_url,
 &>
 
</&>

<&| /page/info_section.mas, 
    collapsible => 1, 
    collapsed   => 0, 
  title       => "Trait phenotype data"
&> 
  
<& trait_phenotype_data.mas,
   pop_id           => $pop_id,
   trait_id         => $trait_id,
   descriptive_stat => $descriptive_stat,
   
 &>

</&>

<& /solgs/pca/analysis.mas &>
<& /solgs/cluster/analysis.mas &>  

% if ($show_data) 
%{

<& /solgs/model/model_parameters.mas, 
   model_parameters => $model_parameters,
&>

<& /solgs/model/accuracy.mas, 
   accuracy_report        => $accuracy_report,
  validation_download_url => $validation_download_url
&>

<& /solgs/model/gebvs.mas, 
   top_blups          => $top_blups,
   blups_download_url => $blups_download_url,
   pop_id             => $pop_id,
  trait_id            => $trait_id
  &>

  <& /solgs/population/gebv_pheno_regression.mas,
        pop_id       => $pop_id,
       trait_id      => $trait_id,
       combo_pops_id => $combo_pops_id,
&>

<& /solgs/model/marker_effects.mas, 
   top_marker_effects          => $top_marker_effects,
   marker_effects_download_url => $marker_effects_download_url
&>

<& selection_populations.mas, 
   selection_prediction_download     => $selection_prediction_download,
   analyzed_traits         => $analyzed_traits,
   pop_id                  => $pop_id,
   project_name            => $project_name,
   prediction_pop_id       => $prediction_pop_id,
   list_of_prediction_pops => $list_of_prediction_pops,
   prediction_pop_name     => $prediction_pop_name, 
&>

%}
% else
%{
<&| /page/info_section.mas, 
  collapsible => 1, 
  collapsed   => 0, 
  title       => "Data Accessibility",
  &>
<p>This is private data.</p>
</&>
%}



<input type="hidden" id="model_id" value="<% $pop_id %>" /> 
<input type="hidden" id="population_id" value="<% $pop_id %>" />
<input type="hidden" id="population_name" value="<% $project_name %>" /> 
<input type="hidden" id="combo_pops_id" value="<% $combo_pops_id %>" /> 
<input type="hidden" id="trait_id" value="<% $trait_id %>" />
<input type="hidden" id="genotyping_protocol_id" value="<% $genotyping_protocol_id %>" />
